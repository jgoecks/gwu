<tool id="addhptovcf" name="Add HP info field">
  <description> to VCF, giving length of adjacent homopolymer</description>
  <command interpreter="perl">
    addHPtoVCF.pl $vcf $gen $out $log
  </command>
  <inputs>
    <param format="vcf" name="vcf" type="data" label="Variants file" help="Should be of the format produced by freebayes. Should list one variant per line."/>
    <param format="fasta" name="gen" type="select" label="Reference genome">
      <options from_data_table="all_fasta"/>
    </param>
  </inputs>
  <outputs>
    <data format="vcf" name="out" label="${tool.name} on ${on_string}: VCF file"/>
    <data format="tabular" name="log" label="${tool.name} on ${on_string}: log file"/>
  </outputs>

  <help>
This tool adds an "HP=x" info field to each variant listed in a VCF, where x
is the length of the homopolymer that matches the variant.

For example, given the following C -> T variant::

  TCAGTCATTTCACACCAGCAA
  TCAGTCATTTTACACCAGCAA
            *

The variant base, T, is adjacent to a homopolymer of three Ts, so the new VCF
record will have "HP=3" in it.

Note that the variant base must match the homopolymer. That is, if the above
variant had been C -> G, the result would have been "HP=0".

Complex variants containing nonmatching variant bases are not evaluated, and
are given the default "HP=0".

In addition, this tool changes "AB=0" info fields to "AB=y", where y is AO/DP,
the allele frequency.

  </help>

</tool>
